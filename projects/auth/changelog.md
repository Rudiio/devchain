- helper.py: Modified `hash_password(password)` to generate a salt using `os.urandom(16)` and concatenate the salt's hexadecimal representation with the password hash before returning.
- helper.py: Updated `hash_password(password)` to generate a salt using `Helper.generate_password_salt()` and concatenate the salt with the password before hashing and returning the combined salt and hash.
- helper.py: Change required in `check_password_hash(stored_hash, password)` to extract the salt from the stored hash and use it to verify the provided password against the stored hash.
- helper.py: Ensure `generate_password_salt()` is utilized in the password hashing process and consider adding utility methods for salt extraction and usage in password hash verification.- user.py: Modified the method `set_password(self, password)` to hash the password using `Helper.hash_password`.
- user.py: Modified the method `check_password(self, password)` to verify the password hash using `Helper.check_password_hash`.- user_manager.py: Added exception handling in `register_user(self, username, password, email)` to raise `BadRequest` with specific messages when the username already exists, the username is invalid, the password does not meet criteria, or the email address is invalid.
- user_manager.py: Added logging within the `register_user` function to print out the description of the `BadRequest` exception for debugging purposes.
- user_manager.py: Ensured that the `register_user` function creates a new `User` object and sets the password correctly if all validations pass, then stores the user in the `self.users` dictionary.- session_manager.py: Imported `Helper` class with `from helper import Helper`.
- session_manager.py: Updated `login_user(self, username, password)` method to use `Helper.check_password_hash` for password verification.- templates/register.html: Corrected the `href` attribute in the `link` tag to point to the existing `styles.css` file within the `static` directory.
- templates/register.html: Created or restored the `styles.css` file in the `static` directory if it was missing.- templates/forgot_password.html: Corrected the `href` attribute in the `link` tag to use Flask's `url_for` function for locating the `styles.css` file within the `static` directory.- app.py: Modified the `register` route to utilize `UserManager.register_user(username, password, email)` for user registration and added exception handling within the route.
- app.py: Ensured `UserManager.register_user` method encapsulates all user validation and exception handling logic.
- app.py: Noted the requirement for implementing password reset logic in the `forgot_password` route for future development, which is not part of the current review.- helper.py: Modified function `def hash_password(password):` to concatenate the generated salt and password hash with a `$` delimiter for storage.
- helper.py: Modified function `def check_password_hash(password_hash, password):` to split the stored password hash into salt and hash using the `$` delimiter and verify the password using the extracted salt.- user.py: Modified the `check_password` method prototype to `def check_password(self, password):`. The method now uses the `Helper` class to check the password hash by calling `Helper().check_password_hash(self.password_hash, password)` or `Helper.check_password_hash(self.password_hash, password)` if it's a static method.